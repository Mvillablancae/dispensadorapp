{% extends "principal/base.html" %}
{% block content %}
    <h1>Programa</h1>
        <p>Dispensador<input type="text" name="fname" id="device" placeholder="Dispensador Casa"></p> 
        <p>Hora<input type="text" name="lname" id="hour" placeholder="hh:mm"></p>
        <p>Fecha<input type="text" id="datepicker" placeholder="dd/mm"><br></p>
        <p>Gramos<input type="text" id="gramos" placeholder="250"><br></p>
        <input type="submit" value="Programar" onclick="sendData()">
        <ul class="list-group" id="list"></ul>
    <script>
        var ws = new WebSocket("ws://192.168.0.31:5678/");
        //var ws = new WebSocket("ws://127.0.0.1:5678/");
        var messages = document.createElement('ul');
        ws.onmessage = function (event) {
            if(event.data[0]!='#'){
                console.log(event.data);
                var messages = document.getElementById('list'),
                message = document.createElement('li'),
                content = document.createTextNode(event.data);
                message.className = "list-group-item";
                message.appendChild(content);
                messages.appendChild(message);
            }
            else{
                print("Mal")
            }
        };
        //Mensaje: ID_IP_DIA_HORA_GR
        function sendData(){
            ws.send(document.getElementById("device").value+"_"+document.getElementById("datepicker").value+"_"+document.getElementById("hour").value
            +"_"+document.getElementById("gramos").value+"\n")
        }

        document.body.appendChild(messages);
    </script>

{% endblock content %}

